---
phase: 01-foundation-detection-routing
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [agents/gsd-executor.md]
autonomous: true
must_haves:
  truths:
    - "gsd-executor can identify task domains from descriptions"
    - "gsd-executor maintains a registry of specialist-to-domain mappings"
    - "Pattern matching correctly identifies Python, TypeScript, Kubernetes, and other domains"
  artifacts:
    - path: "agents/gsd-executor.md"
      provides: "Domain detection section with keyword patterns"
      contains: "<domain_detection>"
    - path: "agents/gsd-executor.md"
      provides: "Specialist registry mapping"
      contains: "<specialist_registry>"
  key_links:
    - from: "domain_detection section"
      to: "task description analysis"
      via: "keyword pattern matching"
      pattern: "detect_specialist_for_task"
---

<objective>
Implement domain detection logic and specialist registry in gsd-executor for identifying task domains and mapping them to appropriate VoltAgent specialists.

Purpose: Enable gsd-executor to analyze task descriptions and determine which specialist would be best suited, forming the foundation for intelligent task delegation.
Output: Modified gsd-executor.md with domain detection capabilities and specialist registry.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-detection-routing/01-RESEARCH.md

# Existing gsd-executor to modify
@agents/gsd-executor.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add specialist registry section</name>
  <files>agents/gsd-executor.md</files>
  <action>
Add a new section `<specialist_registry>` after the `<project_context>` section in gsd-executor.md.

The registry should define:
1. A mapping of task domains to VoltAgent specialist types (127+ specialists supported)
2. Keywords/patterns for each domain (Python, TypeScript, Kubernetes, Docker, etc.)
3. File extensions associated with each domain
4. Complexity thresholds for delegation decisions

Structure as:
- Language specialists (python-pro, typescript-pro, golang-pro, rust-engineer, etc.)
- Infrastructure specialists (kubernetes-specialist, docker-expert, terraform-engineer)
- Data specialists (postgres-pro, database-optimizer, data-engineer)
- Security specialists (security-engineer, penetration-tester)
- Meta specialists (multi-agent-coordinator, workflow-orchestrator)

Use the research findings from 01-RESEARCH.md for the complete list of specialists and their domains.
  </action>
  <verify>grep -n "<specialist_registry>" agents/gsd-executor.md</verify>
  <done>Specialist registry section exists with 127+ specialist mappings</done>
</task>

<task type="auto">
  <name>Task 2: Implement domain detection logic</name>
  <files>agents/gsd-executor.md</files>
  <action>
Add a new section `<domain_detection>` after the `<specialist_registry>` section.

Implement keyword-based pattern matching functions:
1. `detect_specialist_for_task()` - Analyzes task description and returns matching specialist
2. Pattern matching using grep -iE for performance (sub-50ms)
3. Support for multiple keyword matches per domain
4. Priority ordering when multiple specialists match
5. Return empty string when no match (triggers fallback)

The detection should check:
- Task description keywords
- File extensions mentioned in task
- Technology stack indicators
- Domain-specific terminology

Based on research: Use bash grep for MVP, fast and deterministic. Include patterns for all major domains:
- Python: "python|fastapi|django|flask|pytest|pandas|numpy"
- TypeScript: "typescript|react|next\.js|tsx|angular|vue"
- Kubernetes: "kubernetes|k8s|deployment|helm|ingress|pod"
- Database: "postgres|mysql|mongodb|redis|database|schema|migration"
- Security: "security|auth|oauth|jwt|cors|csrf|xss|penetration"

Return the most specific specialist when multiple match (e.g., "django-specialist" over "python-pro" when Django detected).
  </action>
  <verify>grep -n "detect_specialist_for_task" agents/gsd-executor.md</verify>
  <done>Domain detection function exists and can identify specialists from task descriptions</done>
</task>

<task type="auto">
  <name>Task 3: Add complexity threshold logic</name>
  <files>agents/gsd-executor.md</files>
  <action>
Within the `<domain_detection>` section, add complexity evaluation logic:

1. `should_delegate_task()` function that evaluates:
   - File count threshold (>3 files mentioned in task)
   - Line count estimate (>50 lines of new/modified code)
   - Domain expertise benefit (specialist would add clear value)
   - Task type (avoid delegation for simple documentation, config changes)

2. Return delegation decision with reasoning:
   - "delegate": Task meets complexity threshold
   - "direct": Task too simple for delegation overhead

3. Log the reasoning for observability:
   - Which threshold triggered delegation
   - Estimated complexity metrics
   - Domain match confidence

Based on research: Delegation adds 200-500ms overhead, only worthwhile for complex tasks.
Default to direct execution for simple tasks to maintain performance.
  </action>
  <verify>grep -n "should_delegate_task" agents/gsd-executor.md</verify>
  <done>Complexity threshold logic prevents unnecessary delegation of simple tasks</done>
</task>

</tasks>

<verification>
- Domain detection section added to gsd-executor.md
- Specialist registry contains 127+ specialist mappings
- detect_specialist_for_task() function works with keyword patterns
- Complexity threshold prevents simple task delegation
- All major technology domains covered (languages, infra, data, security)
</verification>

<success_criteria>
- gsd-executor can analyze "Create a Python FastAPI endpoint" and return "python-pro"
- gsd-executor can analyze "Deploy to Kubernetes cluster" and return "kubernetes-specialist"
- gsd-executor returns empty string for generic tasks with no domain keywords
- Registry supports all VoltAgent specialists from research
- Complexity logic prevents delegation of single-file changes
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-detection-routing/01-01-SUMMARY.md`
</output>