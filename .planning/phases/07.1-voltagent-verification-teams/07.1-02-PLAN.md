---
phase: 07.1-voltagent-verification-teams
plan: 02
type: execute
wave: 2
depends_on: ["07.1-01"]
files_modified:
  - /Users/matte/Documents/workspace/get-shit-done/get-shit-done/workflows/execute-phase.md
  - /Users/matte/Documents/workspace/get-shit-done/.planning/config.json
  - /Users/matte/Documents/workspace/get-shit-done/get-shit-done/docs/VERIFICATION.md
autonomous: true

must_haves:
  truths:
    - "Multiple verification specialists spawn for higher tier tasks"
    - "Tier 2 tasks get code-reviewer and qa-expert verification"
    - "Tier 3 tasks get full verification team in sequence"
    - "Verification can be disabled via config flag"
    - "Verification results from multiple specialists are aggregated"
  artifacts:
    - path: "/Users/matte/Documents/workspace/get-shit-done/get-shit-done/workflows/execute-phase.md"
      provides: "Multi-specialist verification chains"
      contains: "spawn_verification_team"
    - path: "/Users/matte/Documents/workspace/get-shit-done/.planning/config.json"
      provides: "Verification configuration"
      contains: "verification"
    - path: "/Users/matte/Documents/workspace/get-shit-done/get-shit-done/docs/VERIFICATION.md"
      provides: "Verification patterns documentation"
      min_lines: 100
  key_links:
    - from: "verification tier"
      to: "specialist list"
      via: "tier-to-specialists mapping"
      pattern: "Tier 2.*qa-expert"
    - from: "config.json"
      to: "verification behavior"
      via: "config check"
      pattern: "verification.*enabled"
---

<objective>
Implement multi-specialist verification teams and configuration options

Purpose: Enable tiered verification with multiple specialists for critical tasks
Output: Full verification team support with configurable behavior
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07.1-voltagent-verification-teams/07.1-RESEARCH.md
@.planning/phases/07.1-voltagent-verification-teams/07.1-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend execute-phase for multi-specialist verification</name>
  <files>/Users/matte/Documents/workspace/get-shit-done/get-shit-done/workflows/execute-phase.md</files>
  <action>
    Update the verification logic in execute-phase.md to support multiple specialists based on tier:

    1. Replace single code-reviewer spawn with tier-based team spawning:
       ```markdown
       **Multi-specialist verification:**

       Get specialists for tier:
       ```bash
       SPECIALISTS=$(echo "$TIER_INFO" | jq -r '.specialists[]')
       ```

       For Tier 2-3, spawn specialists in sequence:
       ```bash
       VERIFICATION_PASSED=true
       AGGREGATED_ISSUES=""

       for SPECIALIST in $SPECIALISTS; do
         # Check specialist availability
         if ! grep -q "^- \*\*${SPECIALIST}\*\*:" .planning/available_agents.md 2>/dev/null; then
           echo "Warning: ${SPECIALIST} not available, skipping" >&2
           continue
         fi

         # Spawn specialist with previous findings context
         RESULT=$(Task(
           subagent_type="${SPECIALIST}",
           model="{verifier_model}",
           prompt="
             <objective>
             Review implementation as ${SPECIALIST} specialist.
             ${AGGREGATED_ISSUES:+Previous reviewers found issues - verify they matter for your domain.}
             </objective>

             <files_to_read>
             - {phase_dir}/{plan_file}
             - {phase_dir}/{plan_id}-SUMMARY.md
             - {modified_files}
             - /tmp/verification-brief.md
             ${AGGREGATED_ISSUES:+- /tmp/prior-verification.md}
             </files_to_read>

             <specialist_focus>
             $(case $SPECIALIST in
               code-reviewer) echo "Code quality, security, patterns" ;;
               qa-expert) echo "Test coverage, edge cases, quality metrics" ;;
               principal-engineer) echo "Architecture, scalability, production readiness" ;;
             esac)
             </specialist_focus>
           "
         ))

         # Process result
         STATUS=$(parse_verification_status "$RESULT")
         if [ "$STATUS" = "FAIL" ]; then
           VERIFICATION_PASSED=false
           AGGREGATED_ISSUES="${AGGREGATED_ISSUES}\n\n## ${SPECIALIST} findings:\n${RESULT}"

           # For Tier 3, stop chain on first failure
           if [ "$TIER" = "3" ]; then
             break
           fi
         fi
       done
       ```
       ```

    2. Add aggregation logic for multiple specialist results:
       ```markdown
       Aggregate findings:
       - Combine all issues into unified report
       - Prioritize by severity (FAIL > WARNING > SUGGESTION)
       - De-duplicate common findings
       - Generate overall verification decision
       ```

    3. Add special handling for Tier 3 sequential chain:
       - Stop verification chain if any specialist fails
       - Pass prior findings to next specialist for context
       - Each specialist builds on previous review
  </action>
  <verify>grep -A 30 "Multi-specialist verification" /Users/matte/Documents/workspace/get-shit-done/get-shit-done/workflows/execute-phase.md shows team spawning</verify>
  <done>Execute-phase spawns appropriate verification team based on tier</done>
</task>

<task type="auto">
  <name>Task 2: Add verification configuration to config.json</name>
  <files>/Users/matte/Documents/workspace/get-shit-done/.planning/config.json</files>
  <action>
    Add verification configuration section to config.json:

    ```json
    "verification": {
      "enabled": true,
      "default_tier": 1,
      "tier_overrides": {
        "authentication": 3,
        "payments": 3,
        "database": 2
      },
      "sequential_for_tier_3": true,
      "required_specialists": ["code-reviewer"],
      "optional_specialists": ["qa-expert", "principal-engineer"],
      "fail_on_missing_required": false,
      "aggregate_findings": true
    }
    ```

    Configuration options:
    - `enabled`: Master switch for verification (default: true)
    - `default_tier`: Tier for unclassified tasks (default: 1)
    - `tier_overrides`: Force specific tiers for domain keywords
    - `sequential_for_tier_3`: Run Tier 3 specialists in sequence vs parallel
    - `required_specialists`: Must be available or verification skips
    - `optional_specialists`: Use if available, skip if not
    - `fail_on_missing_required`: Block execution if required specialists missing
    - `aggregate_findings`: Combine results from multiple specialists

    Also update execute-phase.md to read this configuration:
    ```bash
    VERIFICATION_ENABLED=$(node ~/.claude/get-shit-done/bin/gsd-tools.cjs config-get verification.enabled 2>/dev/null || echo "true")
    ```
  </action>
  <verify>jq '.verification' /Users/matte/Documents/workspace/get-shit-done/.planning/config.json shows verification config section</verify>
  <done>Verification behavior is configurable via config.json</done>
</task>

<task type="auto">
  <name>Task 3: Create verification documentation</name>
  <files>/Users/matte/Documents/workspace/get-shit-done/get-shit-done/docs/VERIFICATION.md</files>
  <action>
    Create comprehensive documentation for the verification system:

    # VoltAgent Verification Teams

    ## Overview
    Verification teams provide quality gates through multi-specialist review after task completion.

    ## Verification Tiers

    ### Tier 1 - Light Verification
    - **Specialists:** code-reviewer only
    - **Use for:** Simple changes, configs, documentation
    - **Focus:** Code quality, obvious issues, patterns

    ### Tier 2 - Standard Verification
    - **Specialists:** code-reviewer + qa-expert
    - **Use for:** Feature implementation, business logic
    - **Focus:** + Test coverage, edge cases, error handling

    ### Tier 3 - Deep Verification
    - **Specialists:** code-reviewer + qa-expert + principal-engineer
    - **Use for:** Security, payments, authentication, database changes
    - **Focus:** + Architecture, scalability, production readiness
    - **Execution:** Sequential chain - each specialist builds on prior findings

    ## Tier Classification

    Tasks are automatically classified based on keywords and patterns:
    - Security, auth, payment, crypto → Tier 3
    - API, business-logic, integration → Tier 2
    - Config, docs, UI styling → Tier 1

    Override in PLAN.md task frontmatter:
    ```yaml
    verification_tier: 3
    ```

    ## Configuration

    Configure in `.planning/config.json`:
    ```json
    {
      "verification": {
        "enabled": true,
        "default_tier": 1
      }
    }
    ```

    Disable for specific execution:
    ```bash
    SKIP_VERIFICATION=true /gsd:execute-phase 07.1
    ```

    ## Specialist Responsibilities

    ### code-reviewer
    - Static analysis for vulnerabilities
    - Code pattern compliance
    - Performance implications
    - Technical debt identification

    ### qa-expert
    - Test coverage analysis
    - Edge case identification
    - Quality metrics assessment
    - Regression risk evaluation

    ### principal-engineer
    - Architecture alignment
    - Scalability verification
    - Production readiness
    - Error recovery patterns

    ## Verification Flow

    1. Task completes execution
    2. Orchestrator determines verification tier
    3. Spawns appropriate specialists (parallel or sequential)
    4. Each specialist reviews with their domain focus
    5. Results aggregated into decision
    6. PASS → task marked complete
    7. FAIL → issues reported, user decides next step

    ## Graceful Degradation

    When specialists unavailable:
    - Required specialists missing → Skip verification with warning
    - Optional specialists missing → Continue with available
    - No specialists available → Log warning, mark task complete

    ## Result Aggregation

    Multiple specialist findings are combined:
    - FAIL from any specialist → Overall FAIL
    - All PASS with some WARNING → Overall WARNING
    - All PASS → Overall PASS

    Priority: Security > Functionality > Performance > Style

    ## Examples

    ### Tier 3 Sequential Chain
    ```
    Task: Implement JWT authentication
    1. code-reviewer → Finds SQL injection risk → FAIL
    2. Task sent back for fixes
    3. After fix, verification restarts
    4. code-reviewer → PASS
    5. qa-expert → Missing rate limit tests → WARNING
    6. principal-engineer → Needs refresh token rotation → FAIL
    7. Overall: FAIL (must fix principal's findings)
    ```

    ### Tier 2 Parallel Verification
    ```
    Task: Add user profile API
    1. code-reviewer + qa-expert spawn in parallel
    2. code-reviewer → PASS with style suggestions
    3. qa-expert → WARNING: Consider edge case tests
    4. Overall: WARNING (logged but task proceeds)
    ```
  </action>
  <verify>wc -l /Users/matte/Documents/workspace/get-shit-done/get-shit-done/docs/VERIFICATION.md returns > 100 lines</verify>
  <done>Verification system is fully documented with patterns and examples</done>
</task>

</tasks>

<verification>
- Multi-specialist verification teams spawn based on tier
- Tier 2 gets code-reviewer + qa-expert
- Tier 3 gets full sequential verification chain
- Verification configurable via config.json
- Documentation explains patterns and usage
</verification>

<success_criteria>
- Tier 2 tasks spawn both code-reviewer and qa-expert
- Tier 3 tasks run sequential verification chain
- Verification can be disabled via config
- Multiple specialist results are aggregated correctly
- VERIFICATION.md provides clear usage patterns
</success_criteria>

<output>
After completion, create `.planning/phases/07.1-voltagent-verification-teams/07.1-02-SUMMARY.md`
</output>